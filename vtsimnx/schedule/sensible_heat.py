"""
顕熱（sensible heat）関連のスケジュール。
"""

import numpy as np

from .common import holiday, make_8760_by_holiday

# 顕熱プロファイル（1日24要素 × 平日/休日）
sensible_heat_profiles = {
    "LD": {"平日": [], "休日": []},
    "台所": {"平日": [], "休日": []},
    "浴室": {"平日": [], "休日": []},
    "1階トイレ": {"平日": [], "休日": []},
    "洗面所": {"平日": [], "休日": []},
    "ホール": {"平日": [], "休日": []},
    "寝室": {"平日": [], "休日": []},
    "子供室1": {"平日": [], "休日": []},
    "子供室2": {"平日": [], "休日": []},
}

# 24h base arrays
heat_w_MR = np.zeros(24)  # LD
heat_h_MR = np.zeros(24)
heat_w_KT = np.zeros(24)  # 台所
heat_h_KT = np.zeros(24)
heat_w_BT = np.zeros(24)  # 浴室
heat_h_BT = np.zeros(24)
heat_w_R1 = np.zeros(24)  # 1階トイレ
heat_h_R1 = np.zeros(24)
heat_w_SC = np.zeros(24)  # 洗面所
heat_h_SC = np.zeros(24)
heat_w_H1 = np.zeros(24)  # ホール
heat_h_H1 = np.zeros(24)
heat_w_BR = np.zeros(24)  # 寝室
heat_h_BR = np.zeros(24)
heat_w_C1 = np.zeros(24)  # 子供室1
heat_h_C1 = np.zeros(24)
heat_w_C2 = np.zeros(24)  # 子供室2
heat_h_C2 = np.zeros(24)


# 以降の定義は既存データをそのまま移設（値は変更しない）
# 主たる居室の発熱量
# LD人体
heat_w_MR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       1.000,  2.000,  1.000,  1.000,  0.000,  0.000,
                       1.000,  1.000,  0.000,  0.000,  1.000,  2.000,
                       2.000,  3.000,  3.000,  2.000,  1.000,  1.000]) * 63.0
heat_h_MR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  3.000,  2.000,  2.000,  2.000,
                       2.000,  1.000,  0.000,  0.000,  2.000,  3.000,
                       3.000,  4.000,  2.000,  2.000,  1.000,  0.000]) * 63.0

# LD照明 137.5W
heat_w_MR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.164,  0.709,  0.382,  0.836,  0.127,  0.000,
                       0.491,  0.382,  0.000,  0.000,  0.255,  0.509,
                       0.509,  0.582,  0.873,  0.509,  0.509,  0.255]) * 137.5
heat_h_MR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.873,  1.000,  0.509,  0.509,
                       0.745,  0.291,  0.000,  0.000,  0.509,  0.509,
                       0.582,  0.909,  0.509,  0.509,  0.509,  0.000]) * 137.5

# LD機器 385.08W
heat_w_MR += np.array([0.018,  0.018,  0.018,  0.018,  0.018,  0.018,
                       0.018,  0.543,  0.547,  0.280,  0.149,  0.018,
                       0.280,  0.412,  0.018,  0.018,  0.280,  0.412,
                       0.543,  0.543,  0.543,  0.543,  0.475,  0.475]) * 385.08
heat_h_MR += np.array([0.018,  0.018,  0.018,  0.018,  0.018,  0.018,
                       0.018,  0.018,  0.543,  0.543,  1.000,  0.932,
                       0.543,  0.149,  0.018,  0.018,  0.280,  0.543,
                       0.543,  0.280,  0.543,  0.543,  0.475,  0.018]) * 385.08

# 台所の発熱量
# 台所照明 36.75W
heat_w_KT += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.463,  0.463,  0.000,  0.667,  0.000,  0.000,
                       0.925,  0.000,  0.000,  0.000,  0.925,  0.000,
                       0.925,  0.925,  0.925,  0.000,  0.000,  0.000]) * 36.75
heat_h_KT += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.925,  1.000,  0.000,  0.000,
                       0.925,  0.463,  0.000,  0.000,  0.000,  0.925,
                       0.925,  0.925,  0.000,  0.000,  0.000,  0.000]) * 36.75

# 台所機器 60W
heat_w_KT += np.array([1.000] * 24) * 60.00
heat_h_KT += np.array([1.000] * 24) * 60.00

# 台所機器 34.76W
heat_w_KT += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.500,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.500,  0.000,  0.000,  0.000,  0.000,  0.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 34.76
heat_h_KT += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.500,  0.000,  0.000,  0.000,
                       0.500,  0.000,  0.000,  0.000,  0.000,  1.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 34.76

# 浴室の発熱量
# 浴室照明 40.5W
heat_w_BT += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.333,  0.667,  1.000,  0.000]) * 40.5
heat_h_BT += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.667,  0.333,
                       0.000,  0.000,  0.000,  0.667,  1.000,  0.000]) * 40.5

# トイレの発熱量
# トイレ機器 30.0W
heat_w_R1 += np.array([1.000] * 24) * 30.0
heat_h_R1 += np.array([1.000] * 24) * 30.0

# トイレ照明 8.55W
heat_w_R1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       1.000,  0.333,  0.000,  0.111,  0.000,  0.000,
                       0.111,  0.000,  0.000,  0.000,  0.111,  0.111,
                       0.111,  0.111,  0.111,  0.333,  0.000,  0.444]) * 8.55
heat_h_R1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.667,  0.667,  0.000,  0.222,  0.222,
                       0.000,  0.000,  0.000,  0.000,  0.333,  0.111,
                       0.000,  0.333,  0.111,  0.000,  0.333,  0.111]) * 8.55

# 洗面室の発熱
# 洗面脱衣照明 66.5W
heat_w_SC += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.286,  0.571,  0.238,  0.524,  0.286,  0.000,
                       0.000,  0.286,  0.000,  0.000,  0.095,  0.095,
                       0.190,  0.286,  0.214,  1.000,  0.929,  0.286]) * 66.5
heat_h_SC += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.786,  0.786,  0.857,  0.000,  0.095,
                       0.000,  0.000,  0.000,  0.000,  0.452,  0.500,
                       0.190,  0.000,  0.000,  0.714,  0.929,  0.286]) * 66.5

# 洗面脱衣機器 118.75W
heat_w_SC += np.array([0.097,  0.097,  0.097,  0.097,  0.097,  0.097,
                       0.097,  0.548,  0.227,  0.097,  0.097,  0.097,
                       0.097,  0.097,  0.097,  0.097,  0.097,  0.097,
                       0.097,  0.097,  0.097,  1.000,  0.097,  0.548]) * 118.75
heat_h_SC += np.array([0.097,  0.097,  0.097,  0.097,  0.097,  0.097,
                       0.097,  0.548,  0.227,  0.097,  0.097,  0.097,
                       0.097,  0.097,  0.097,  0.097,  0.097,  0.548,
                       0.097,  0.097,  0.097,  0.548,  0.097,  0.548]) * 118.75

# ホールの発熱
# ホール照明 57W
heat_w_H1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.500,  1.000,  1.000,  1.000,  0.500,  0.000,
                       0.000,  0.000,  0.000,  0.000,  1.000,  1.000,
                       1.000,  1.000,  1.000,  1.000,  1.000,  0.500]) * 57.0
heat_h_H1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.750,  1.000,  1.000,  1.000,  1.000,
                       1.000,  0.250,  0.000,  0.000,  0.000,  0.000,
                       0.500,  1.000,  1.000,  1.000,  1.000,  0.250]) * 57.0

# ホール照明 114W
heat_w_H1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.250,  0.500,  0.250,  0.500,  0.250,  0.000,
                       0.000,  0.250,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.250,  1.000,  1.000,  0.250]) * 114.0
heat_h_H1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.750,  0.750,  1.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.500,  0.250,
                       0.000,  0.000,  0.000,  0.250,  0.250,  0.250]) * 114.0

# 寝室の発熱量
# 寝室人体
heat_w_BR += np.array([2.000,  2.000,  2.000,  2.000,  2.000,  2.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  1.000]) * 63.0
heat_h_BR += np.array([2.000,  2.000,  2.000,  2.000,  2.000,  2.000,
                       2.000,  1.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  2.000]) * 63.0

# 寝室照明 52.5W
heat_w_BR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.667,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 52.5
heat_h_BR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 52.5

# 寝室照明 412.5W
heat_w_BR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.667,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 412.5
heat_h_BR += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 412.5

# 子供室1の発熱量
# 子供室1人体
heat_w_C1 += np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  1.000,  0.000,  1.000,  1.000]) * 63.0
heat_h_C1 += np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
                       1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
                       0.000,  0.000,  0.000,  0.000,  1.000,  1.000,
                       1.000,  0.000,  1.000,  1.000,  1.000,  1.000]) * 63.0

# 子供室1照明 70W
heat_w_C1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.500,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.750,  0.250,  1.000,  1.000]) * 70.0
heat_h_C1 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.750,  1.000,  1.000,
                       0.000,  0.000,  0.000,  0.000,  1.000,  1.000,
                       0.500,  0.000,  1.000,  0.250,  1.000,  0.000]) * 70.0

# 子供室1照明 80W
heat_w_C1 += np.array([0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
                       0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
                       0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
                       0.188,  0.188,  0.750,  0.375,  1.000,  0.438]) * 80.0
heat_h_C1 += np.array([0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
                       0.188,  0.188,  0.188,  0.797,  1.000,  1.000,
                       0.188,  0.188,  0.188,  0.188,  0.250,  0.250,
                       0.219,  0.188,  1.000,  0.391,  1.000,  0.188]) * 80.0

# 子供室2の発熱量
# 子供室2人体
heat_w_C2 += np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  1.000,  1.000,  1.000]) * 63.0
heat_h_C2 += np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
                       1.000,  1.000,  0.000,  1.000,  1.000,  1.000,
                       1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  1.000,  1.000,  1.000,  1.000]) * 63.0

# 子供室2照明 70W
heat_w_C2 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.500,  0.000,  0.000,
                       0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.500,  0.500,  0.000,  0.750,  1.000,  0.250]) * 70.0
heat_h_C2 += np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  0.250,  1.000,  1.000,  1.000,
                       0.500,  0.000,  0.000,  0.000,  0.000,  0.000,
                       0.000,  0.000,  1.000,  1.000,  1.000,  0.000]) * 70.0

# 子供室2照明 50W
heat_w_C2 += np.array([0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
                       0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
                       0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
                       0.060,  0.060,  0.060,  0.000,  0.765,  0.295]) * 50.0
heat_h_C2 += np.array([0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
                       0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
                       0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
                       0.060,  0.060,  1.000,  1.000,  1.000,  0.060]) * 50.0


def build_sensible_heat_schedule(*, holiday_days=holiday):
    """
    顕熱（sensible heat）スケジュールを生成する。
    """
    sensible_heat_profiles["LD"]["平日"] = heat_w_MR.tolist()
    sensible_heat_profiles["LD"]["休日"] = heat_h_MR.tolist()
    sensible_heat_profiles["台所"]["平日"] = heat_w_KT.tolist()
    sensible_heat_profiles["台所"]["休日"] = heat_h_KT.tolist()
    sensible_heat_profiles["浴室"]["平日"] = heat_w_BT.tolist()
    sensible_heat_profiles["浴室"]["休日"] = heat_h_BT.tolist()
    sensible_heat_profiles["1階トイレ"]["平日"] = heat_w_R1.tolist()
    sensible_heat_profiles["1階トイレ"]["休日"] = heat_h_R1.tolist()
    sensible_heat_profiles["洗面所"]["平日"] = heat_w_SC.tolist()
    sensible_heat_profiles["洗面所"]["休日"] = heat_h_SC.tolist()
    sensible_heat_profiles["ホール"]["平日"] = heat_w_H1.tolist()
    sensible_heat_profiles["ホール"]["休日"] = heat_h_H1.tolist()
    sensible_heat_profiles["寝室"]["平日"] = heat_w_BR.tolist()
    sensible_heat_profiles["寝室"]["休日"] = heat_h_BR.tolist()
    sensible_heat_profiles["子供室1"]["平日"] = heat_w_C1.tolist()
    sensible_heat_profiles["子供室1"]["休日"] = heat_h_C1.tolist()
    sensible_heat_profiles["子供室2"]["平日"] = heat_w_C2.tolist()
    sensible_heat_profiles["子供室2"]["休日"] = heat_h_C2.tolist()

    return {
        room: make_8760_by_holiday(
            holiday_days,
            sensible_heat_profiles[room]["平日"],
            sensible_heat_profiles[room]["休日"],
            default=0.0,
        )
        for room in sensible_heat_profiles.keys()
    }


sensible_heat = build_sensible_heat_schedule()

__all__ = [
    "sensible_heat_profiles",
    "build_sensible_heat_schedule",
    "sensible_heat",
    # base arrays
    "heat_w_MR", "heat_h_MR",
    "heat_w_KT", "heat_h_KT",
    "heat_w_BT", "heat_h_BT",
    "heat_w_R1", "heat_h_R1",
    "heat_w_SC", "heat_h_SC",
    "heat_w_H1", "heat_h_H1",
    "heat_w_BR", "heat_h_BR",
    "heat_w_C1", "heat_h_C1",
    "heat_w_C2", "heat_h_C2",
]


