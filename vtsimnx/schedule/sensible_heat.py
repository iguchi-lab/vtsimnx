"""
顕熱（sensible heat）関連のスケジュール。
"""

import numpy as np

from .common import holiday, make_8760_by_holiday

# 顕熱プロファイル（1日24要素 × 平日/休日）
sensible_heat_profiles = {
    "LD": {
        "人体": {"平日": [], "休日": []},
        "照明": {"平日": [], "休日": []},
        "機器": {"平日": [], "休日": []}
    },
    "台所": {
        "照明": {"平日": [], "休日": []},
        "機器1": {"平日": [], "休日": []},
        "機器2": {"平日": [], "休日": []}
    },
    "浴室": {
        "照明": {"平日": [], "休日": []}
    },
    "1階トイレ": {
        "照明": {"平日": [], "休日": []},
        "機器": {"平日": [], "休日": []}
    },
    "洗面所": {
        "照明": {"平日": [], "休日": []},
        "機器": {"平日": [], "休日": []}
    },
    "ホール": {
        "照明1": {"平日": [], "休日": []},
        "照明2": {"平日": [], "休日": []}
    },
    "寝室": {        
        "人体": {"平日": [], "休日": []},
        "照明": {"平日": [], "休日": []},
        "機器": {"平日": [], "休日": []}
    },
    "子供室1": {        
        "人体": {"平日": [], "休日": []},
        "照明": {"平日": [], "休日": []},
        "機器": {"平日": [], "休日": []}
    },
    "子供室2": {
        "人体": {"平日": [], "休日": []},
        "照明": {"平日": [], "休日": []},
        "機器": {"平日": [], "休日": []}
    },
}

# 以降の定義は既存データをそのまま移設（値は変更しない）
# 主たる居室の発熱量
# LD人体    人体：対流成分50%、放射成分50%
sensible_heat_profiles["LD"]["人体"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              1.000,  2.000,  1.000,  1.000,  0.000,  0.000,
              1.000,  1.000,  0.000,  0.000,  1.000,  2.000,
              2.000,  3.000,  3.000,  2.000,  1.000,  1.000]) * 63.0
).tolist()

sensible_heat_profiles["LD"]["人体"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  3.000,  2.000,  2.000,  2.000,
              2.000,  1.000,  0.000,  0.000,  2.000,  3.000,
              3.000,  4.000,  2.000,  2.000,  1.000,  0.000]) * 63.0
).tolist()

# LD照明 137.5W  蛍光灯：対流成分60%、放射成分40%
sensible_heat_profiles["LD"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.164,  0.709,  0.382,  0.836,  0.127,  0.000,
              0.491,  0.382,  0.000,  0.000,  0.255,  0.509,
              0.509,  0.582,  0.873,  0.509,  0.509,  0.255]) * 137.5 * 1.2
).tolist()

sensible_heat_profiles["LD"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.873,  1.000,  0.509,  0.509,
              0.745,  0.291,  0.000,  0.000,  0.509,  0.509,
              0.582,  0.909,  0.509,  0.509,  0.509,  0.000]) * 137.5 * 1.2
).tolist()

# LD機器 385.08W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["LD"]["機器"]["平日"] = (
    np.array([0.018,  0.018,  0.018,  0.018,  0.018,  0.018,
              0.018,  0.543,  0.547,  0.280,  0.149,  0.018,
              0.280,  0.412,  0.018,  0.018,  0.280,  0.412,
              0.543,  0.543,  0.543,  0.543,  0.475,  0.475]) * 385.08
).tolist()
sensible_heat_profiles["LD"]["機器"]["休日"] = (
    np.array([0.018,  0.018,  0.018,  0.018,  0.018,  0.018,
              0.018,  0.018,  0.543,  0.543,  1.000,  0.932,
              0.543,  0.149,  0.018,  0.018,  0.280,  0.543,
              0.543,  0.280,  0.543,  0.543,  0.475,  0.018]) * 385.08
).tolist()

# 台所の発熱量
# 台所照明 36.75W  蛍光灯：対流成分60%、放射成分40%
sensible_heat_profiles["台所"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.463,  0.463,  0.000,  0.667,  0.000,  0.000,
              0.925,  0.000,  0.000,  0.000,  0.925,  0.000,
              0.925,  0.925,  0.925,  0.000,  0.000,  0.000]) * 36.75 * 1.2
).tolist()
sensible_heat_profiles["台所"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.925,  1.000,  0.000,  0.000,
              0.925,  0.463,  0.000,  0.000,  0.000,  0.925,
              0.925,  0.925,  0.000,  0.000,  0.000,  0.000]) * 36.75 * 1.2
).tolist()

# 台所機器 60W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["台所"]["機器1"]["平日"] = (np.array([1.000] * 24) * 60.00).tolist()
sensible_heat_profiles["台所"]["機器1"]["休日"] = (np.array([1.000] * 24) * 60.00).tolist()

# 台所機器 34.76W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["台所"]["機器2"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.500,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.500,  0.000,  0.000,  0.000,  0.000,  0.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 34.76
).tolist()
sensible_heat_profiles["台所"]["機器2"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.500,  0.000,  0.000,  0.000,
              0.500,  0.000,  0.000,  0.000,  0.000,  1.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 34.76
).tolist()

# 浴室の発熱量
# 浴室照明 40.5W  白熱灯：対流成分40%、放射成分60%
sensible_heat_profiles["浴室"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.333,  0.667,  1.000,  0.000]) * 40.5
).tolist()
sensible_heat_profiles["浴室"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.667,  0.333,
              0.000,  0.000,  0.000,  0.667,  1.000,  0.000]) * 40.5
).tolist()

# トイレ照明 8.55W  白熱灯：対流成分40%、放射成分60%
sensible_heat_profiles["1階トイレ"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              1.000,  0.333,  0.000,  0.111,  0.000,  0.000,
              0.111,  0.000,  0.000,  0.000,  0.111,  0.111,
              0.111,  0.111,  0.111,  0.333,  0.000,  0.444]) * 8.55
).tolist()
sensible_heat_profiles["1階トイレ"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.667,  0.667,  0.000,  0.222,  0.222,
              0.000,  0.000,  0.000,  0.000,  0.333,  0.111,
              0.000,  0.333,  0.111,  0.000,  0.333,  0.111]) * 8.55
).tolist()
# トイレの発熱量
# トイレ機器 30.0W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["1階トイレ"]["機器"]["平日"] = (np.array([1.000] * 24) * 30.0).tolist()
sensible_heat_profiles["1階トイレ"]["機器"]["休日"] = (np.array([1.000] * 24) * 30.0).tolist()

# 洗面室の発熱
# 洗面脱衣照明 66.5W  白熱灯：対流成分40%、放射成分60%
sensible_heat_profiles["洗面所"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.286,  0.571,  0.238,  0.524,  0.286,  0.000,
              0.000,  0.286,  0.000,  0.000,  0.095,  0.095,
              0.190,  0.286,  0.214,  1.000,  0.929,  0.286]) * 66.5
).tolist()
sensible_heat_profiles["洗面所"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.786,  0.786,  0.857,  0.000,  0.095,
              0.000,  0.000,  0.000,  0.000,  0.452,  0.500,
              0.190,  0.000,  0.000,  0.714,  0.929,  0.286]) * 66.5
).tolist()

# 洗面脱衣機器 118.75W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["洗面所"]["機器"]["平日"] = (
    np.array([0.097,  0.097,  0.097,  0.097,  0.097,  0.097,
              0.097,  0.548,  0.227,  0.097,  0.097,  0.097,
              0.097,  0.097,  0.097,  0.097,  0.097,  0.097,
              0.097,  0.097,  0.097,  1.000,  0.097,  0.548]) * 118.75
).tolist()
sensible_heat_profiles["洗面所"]["機器"]["休日"] = (
    np.array([0.097,  0.097,  0.097,  0.097,  0.097,  0.097,
              0.097,  0.548,  0.227,  0.097,  0.097,  0.097,
              0.097,  0.097,  0.097,  0.097,  0.097,  0.548,
              0.097,  0.097,  0.097,  0.548,  0.097,  0.548]) * 118.75
).tolist()

# ホールの発熱
# ホール照明 57W  白熱灯：対流成分40%、放射成分60%
sensible_heat_profiles["ホール"]["照明1"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.500,  1.000,  1.000,  1.000,  0.500,  0.000,
              0.000,  0.000,  0.000,  0.000,  1.000,  1.000,
              1.000,  1.000,  1.000,  1.000,  1.000,  0.500]) * 57.0
).tolist()
sensible_heat_profiles["ホール"]["照明1"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.750,  1.000,  1.000,  1.000,  1.000,
              1.000,  0.250,  0.000,  0.000,  0.000,  0.000,
              0.500,  1.000,  1.000,  1.000,  1.000,  0.250]) * 57.0
).tolist()

# ホール照明 114W  白熱灯：対流成分40%、放射成分60%
sensible_heat_profiles["ホール"]["照明2"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.250,  0.500,  0.250,  0.500,  0.250,  0.000,
              0.000,  0.250,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.250,  1.000,  1.000,  0.250]) * 114.0
).tolist()
sensible_heat_profiles["ホール"]["照明2"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.750,  0.750,  1.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.500,  0.250,
              0.000,  0.000,  0.000,  0.250,  0.250,  0.250]) * 114.0
).tolist()

# 寝室の発熱量
# 寝室人体  人体：対流成分50%、放射成分50%
sensible_heat_profiles["寝室"]["人体"]["平日"] = (
    np.array([2.000,  2.000,  2.000,  2.000,  2.000,  2.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  1.000]) * 63.0
).tolist()
sensible_heat_profiles["寝室"]["人体"]["休日"] = (
    np.array([2.000,  2.000,  2.000,  2.000,  2.000,  2.000,
              2.000,  1.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  2.000]) * 63.0
).tolist()

# 寝室照明 52.5W  蛍光灯：対流成分60%、放射成分40%
sensible_heat_profiles["寝室"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.667,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 52.5 * 1.2
).tolist()
sensible_heat_profiles["寝室"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 52.5 * 1.2
).tolist()

# 寝室機器 412.5W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["寝室"]["機器"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.667,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 412.5
).tolist()
sensible_heat_profiles["寝室"]["機器"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000]) * 412.5
).tolist()

# 子供室1の発熱量
# 子供室1人体  人体：対流成分50%、放射成分50%
sensible_heat_profiles["子供室1"]["人体"]["平日"] = (
    np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  1.000,  0.000,  1.000,  1.000]) * 63.0
).tolist()
sensible_heat_profiles["子供室1"]["人体"]["休日"] = (
    np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
              1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
              0.000,  0.000,  0.000,  0.000,  1.000,  1.000,
              1.000,  0.000,  1.000,  1.000,  1.000,  1.000]) * 63.0
).tolist()

# 子供室1照明 70W  蛍光灯：対流成分60%、放射成分40%
sensible_heat_profiles["子供室1"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.500,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.750,  0.250,  1.000,  1.000]) * 70.0 * 1.2
).tolist()
sensible_heat_profiles["子供室1"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.750,  1.000,  1.000,
              0.000,  0.000,  0.000,  0.000,  1.000,  1.000,
              0.500,  0.000,  1.000,  0.250,  1.000,  0.000]) * 70.0 * 1.2
).tolist()

# 子供室1機器 80W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["子供室1"]["機器"]["平日"] = (
    np.array([0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
              0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
              0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
              0.188,  0.188,  0.750,  0.375,  1.000,  0.438]) * 80.0
).tolist()
sensible_heat_profiles["子供室1"]["機器"]["休日"] = (
    np.array([0.188,  0.188,  0.188,  0.188,  0.188,  0.188,
              0.188,  0.188,  0.188,  0.797,  1.000,  1.000,
              0.188,  0.188,  0.188,  0.188,  0.250,  0.250,
              0.219,  0.188,  1.000,  0.391,  1.000,  0.188]) * 80.0
).tolist()

# 子供室2の発熱量
# 子供室2人体  人体：対流成分50%、放射成分50%
sensible_heat_profiles["子供室2"]["人体"]["平日"] = (
    np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              1.000,  0.000,  0.000,  1.000,  1.000,  1.000]) * 63.0
).tolist()
sensible_heat_profiles["子供室2"]["人体"]["休日"] = (
    np.array([1.000,  1.000,  1.000,  1.000,  1.000,  1.000,
              1.000,  1.000,  0.000,  1.000,  1.000,  1.000,
              1.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  1.000,  1.000,  1.000,  1.000]) * 63.0
).tolist()

# 子供室2照明 70W  蛍光灯：対流成分60%、放射成分40%
sensible_heat_profiles["子供室2"]["照明"]["平日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.500,  0.000,  0.000,
              0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.500,  0.500,  0.000,  0.750,  1.000,  0.250]) * 70.0 * 1.2
).tolist()
sensible_heat_profiles["子供室2"]["照明"]["休日"] = (
    np.array([0.000,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  0.250,  1.000,  1.000,  1.000,
              0.500,  0.000,  0.000,  0.000,  0.000,  0.000,
              0.000,  0.000,  1.000,  1.000,  1.000,  0.000]) * 70.0 * 1.2
).tolist()

# 子供室2機器 50W  機器：対流成分60%、放射成分40%
sensible_heat_profiles["子供室2"]["機器"]["平日"] = (
    np.array([0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
              0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
              0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
              0.060,  0.060,  0.060,  0.000,  0.765,  0.295]) * 50.0
).tolist()
sensible_heat_profiles["子供室2"]["機器"]["休日"] = (
    np.array([0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
              0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
              0.060,  0.060,  0.060,  0.060,  0.060,  0.060,
              0.060,  0.060,  1.000,  1.000,  1.000,  0.060]) * 50.0
).tolist()


def build_sensible_heat_schedule(*, holiday_days=holiday):
    """
    顕熱（sensible heat）スケジュールを生成する。
    """
    out = {}
    for room, by_use in sensible_heat_profiles.items():
        # 用途（人体/照明/機器…）ごとに 8760 を生成する（合算しない）
        out[room] = {
            use_name: make_8760_by_holiday(
                holiday_days,
                profs["平日"],
                profs["休日"],
                default=0.0,
            )
            for use_name, profs in by_use.items()
        }
    return out


sensible_heat = build_sensible_heat_schedule()

__all__ = [
    "sensible_heat_profiles",
    "build_sensible_heat_schedule",
    "sensible_heat",
]


